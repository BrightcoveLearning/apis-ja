---
title:  'APIリクエストにInsomniaを使用する'
description:  'このトピックでは、人気のあるInsomniaHTTPクライアントをセットアップしてBrightcove RESTful APIにリクエストを送信する方法を学習します。'
parent: General Information
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="introduction">はじめに</h2>
    <p>プラットフォームAPIドキュメントの多くの例で使用されているcurlステートメントとコマンドラインは、難しくて威圧的であると感じる人もいます。このような場合、Brightcove API のほとんどを含む REST ベースのサービスに HTTP リクエストを送信するためのツールが多数用意されています。このドキュメントでは、人気のあるツールの1つである<a href="https://insomnia.rest"><span translate="No">Insomnia</span>アプリ</a>の使用方法を説明します。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Install_insomnia"><span translate="No">Insomnia</span>のインストール</h2>
    <p><a href="https://insomnia.rest"><span translate="No">https://insomnia.rest</span></a>から<span translate="No">Insomnia</span>を入手して下さい。<span translate="No">Insomnia</span> は、Mac、Linux、またはWindowsシステムにインストールすることができます。</p>
		</section>
		<section class="bcls-section">
			<h2 id="authentication">認証</h2>
    <p><span translate="No">Insomnia</span> は、BrightcoveのRESTfull APIへのリクエストに使用できます。ほとんどのAPIは認証にOAuth2を使用しており、このドキュメントの後半で<span translate="no">Insomnia</span>でそれを設定する方法を説明します。一方、適切なヘッダーを設定するだけで、OAuthを使用しないAPIにも使用できます。</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="Set Header in Insomnia" src="/assets/images/general/insomnia/18462-set-header.png" />
      <figcaption class="bcls-caption--image"><span translate="No">Insomnia</span>ヘッダーを設定する</figcaption>
    </figure>
    <p>Oauth2以外の認証方法を使用したリクエストのヘッダーは次のようになります。</p>
    <dl>
      <dt ><a href="/playback/index.html"><span translate="No">Playback API</span></a></dt>
      <dd >
        <pre>
  <code class="language-http" translate="No">BCOV-Policy: <span class="bcls-input">YOUR_POLICY_KEY</span></code></pre>
      </dd>
      <dt ><a href="https://live.support.brightcove.com/live-api/"><span translate="No">ライブAPI</span></a></dt>
      <dd >
        <pre>
  <code class="language-http" translate="No">X-API-KEY: <span class="bcls-input">YOUR_API_KEY</span></code></pre>
      </dd>
      <dt ><a href="https://zencoder.support.brightcove.com">Zencoder API </a></dt>
      <dd >
        <pre>
  <code class="language-http" translate="No">Zencoder-Api-Key: <span class="bcls-input">YOUR_API_KEY</span></code></pre>
      </dd>
    </dl>
  </section>
  <section class="bcls-section">
    <h2 id="getCredentials">クライアント認証情報を取得する</h2>
    <p>大部分のBrightcove APIを使用するには、使用するアカウントとAPIのクライアント認証情報が必要です。<a href="/general/managing-api-authentication-credentials.html"> 「API 認証資格情報の管理」の説明に従って、Studioでクライアント認証情報を取得します</a>。以下の手順では、<span translate="No">Insomnia</span>を使用して<span translate="No"> CMS API</span>リクエストを作成するため、資格情報には少なくとも次の権限が必要です。</p>
    <ul>
      <li><strong>Video</strong>：<strong>Read/Write</strong></li>
    </ul>
    <p>より広い範囲の API リクエストに使用できる認証情報を取得するために、好きなだけ追加のパーミッションを追加することができます。また、複数のアカウントで使用できる認証情報を取得することもできます。</p>
    <aside class="bcls-aside bcls-aside--information">クライアントのクレデンシャルを生成するには、Studioの管理者権限を持っているか、組織内で管理者権限を持っている人にクレデンシャルを生成してもらう必要があります。</aside>
  </section>
  <section class="bcls-section">
    <h2 id="usingInsomnia"><span translate="No">Insomnia</span>の使用</h2>
    <p>クライアントの認証情報を取得したら、<span translate="No">Insomnia</span>を使い始める準備ができています。CMS APIのOpenAPI仕様をインポートし、<span translate="No">Insomnia</span> で多くのセットアップ作業が行われます。以下の手順では、<span translate="No">Insomnia</span>を使っていくつかの<strong> CMS API</strong> リクエストを作成する手順を説明します。</p>
    <h3>CMS APIコレクションの<span translate="No">Insomnia</span>のセットアップ</h3>
		<h4>CMS APIのOpenAPI仕様を取得します</h4>
		<ol class="bcls-tasklist-restart">
			<li><a href="/cms/references/reference.html">CMS APIリファレンス</a>を開きます。</li>
			<li>
				<strong>ダウンロード</strong>ボタンをクリックして、<code translate="no">openapi.yaml</code>ファイルを再び見つけられる場所に保存して下さい：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/download-cms-api-openapi-spec.png" alt="Download Open API Specification">
					<figcaption class="bcls-caption--image">OpenAPI仕様をダウンロードする</figcaption>
				</figure>
			</li>
		</ol>
		<h4>OpenAPI仕様をInsomniaにインポートします</h4>
    <ol class="bcls-tasklist-restart">
      <li><span translate="No">Insomnia</span>アプリを起動します。</li>
      <li><span translate="No">Insomnia</span>の横にあるドロップダウンをクリックし、<strong>Import/Export</strong>を選択します：
        <figure class="bcls-figure"><img class="bcls-image" alt="Import/Export" src="/assets/images/general/insomnia/import-export.png" />
          <figcaption class="bcls-caption--image">インポート・エクスポート</figcaption>
        </figure>
      </li>
			<li>
				開いたダイアログで、<strong>Import Data</strong>から<strong>From File</strong>をクリックします：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/import-data-from-file.png" alt="Import Data from File">
					<figcaption class="bcls-caption--image">ファイルからデータをインポートする</figcaption>
				</figure>
			</li>
			<li>
				ダウンロードした<code translate="no">openapi.yaml</code>ファイルを選択し、現在のワークスペースにインポートするか、新しいワークスペースを作成するかを選択します。どちらでも機能しますが、各APIごとに新しいワークスペースを作成することをお勧めします。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/create-new-workspace.png" alt="Create New Workspace">
					<figcaption class="bcls-caption--image">新しいワークスペースを作成する</figcaption>
				</figure>
			</li>
			<li>
				次に、データをリクエストコレクションとしてインポートするかデザインドキュメントとしてインポートするかを尋ねられます。<strong>Request Collection</strong>を選択します：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/import-request-collection.png" alt="Import as Request Collection">
					<figcaption class="bcls-caption--image">リクエストコレクションとしてインポート</figcaption>
				</figure>
			</li>
			<li>データがインポートされたことを確認するダイアログが表示されます。</li>
			<li>
				左上にある<strong>Dashboard</strong>をクリックすると、ワークスペースが表示されます。新しいワークスペースを作成した場合は、適切な名前で表示されます。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/cms-api-workspace.png" alt="CMS API Workspace">
					<figcaption class="bcls-caption--image">CMS APIワークスペース</figcaption>
				</figure>
			</li>
      <li>ワークスペースをクリックして開きます。</li>
			<li>
				CMS APIに対するさまざまなリクエストのグループと、新しいOpenAPI環境を含むフォルダーのリストが表示されます。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/cms-api-evironment-and-request-folders.png" alt="CMS API Requests and Environment">
					<figcaption class="bcls-caption--image">CMS APIリクエストと環境</figcaption>
				</figure>
			</li>
    </ol>
  </section>
	<section class="bcls-section">
		<h2 id="add_variables_to_environment">環境に変数を追加する</h2>
		<p>これはオプションの手順ですが、後でリクエストの認証設定を簡略化することができます。</p>
		<ol class="bcls-tasklist-restart">
			<li>
				<strong>OpenAPI env</strong>のドロップダウンメニューをクリックし、<strong>Manage Environments</strong>を選択します：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/" alt="Manage Environments">
					<figcaption class="bcls-caption--image">環境の管理</figcaption>
				</figure>
			</li>
			<li>
				<span translate="no">Insomnia</span> がOpenAPIの仕様から作成した環境変数がJSON形式で表示されます：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/environment-json.png" alt="Environment Variables">
					<figcaption class="bcls-caption--image">環境変数</figcaption>
				</figure>
			</li>
			<li>
				これらの追加変数をJSONに追加します (<code translate="no">client_id</code>と<code translate="no">client_secret</code> については、上記の<a href="#getCredentials">クライアントの資格情報を取得する</a>を参照して下さい）：
				<ul>
					<li><code translate="no">"account_id"： " <span class="bcls-input"> your_account_id</span>「」</code></li>
					<li><code translate="no">"client_id"： " <span class="bcls-input"> your_client_id</span>「」</code></li>
					<li><code translate="no">"client_secret"： " <span class="bcls-input"> your_client_secret</span>「」</code></li>
					<li><code translate="no">"access_token_url"： "https://oauth.brightcove.com/v4/access_token"</code></li>
				</ul>
			</li>
			<li>
				終了すると、環境JSONは次のようになります。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/environment-vars-added.png" alt="Environment Variables Added">
					<figcaption class="bcls-caption--image">追加された環境変数</figcaption>
				</figure>
			</li>
			<li>右下の<strong>Done</strong>をクリックしてダイアログを終了します。</li>
		</ol>
	</section>
  <section class="bcls-section">
    <h2 id="Set_up_authentication">認証を設定する</h2>
    <p>これで、APIリクエストの認証を設定する準備が整いました。</p>
    <ol class="bcls-tasklist-restart">
      <li><strong>Video</strong>フォルダをクリックし、<strong>Get Videos</strong>を選択します：
        <figure class="bcls-figure"><img class="bcls-image" alt="New Request" src="/assets/images/general/insomnia/18462-new-request.png" />
          <figcaption class="bcls-caption--image">新しいリクエスト</figcaption>
        </figure>
      </li>
			<li>
				リクエストのURLには既に2つの変数が含まれていることに注意してください。<code translate="no"> base_url</code>はOpenAPI仕様から<span class="”notranslate”">Insomnia</span>が自動的に生成したものです。<code translate="no">account_id</code>をクリックすると、前のセクションで環境変数として入力した値と一致することがわかります。</li>
      <li>
				<strong>>Auth</strong>タブと<strong>Authドロップダウン</strong>メニューをクリックし、<strong> OAuth 2.0</strong>を選択します：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/select-auth-type.png" alt="Select Auth Type">
					<figcaption class="bcls-caption--image">認証タイプを選択します</figcaption>
				</figure>
			</li>
      <li>
				<strong>Grant Type</strong>ドロップダウンをクリックし、<strong>Client Credentials</strong>を選択します：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/" alt="Select Grant Type">
					<figcaption class="bcls-caption--image">Grant Typeを選択</figcaption>
				</figure>
      </li>
      <li>
				<strong>Access Token URL</strong>フィールドで、「access_token_url」と入力し始めます-オートコンプリートメニューが表示されますので、環境変数<code translate="no"> access_token_url</code>を選択して下さい：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/access-token-url.png" alt="Autocomplete for Variables">
					<figcaption class="bcls-caption--image">変数のオートコンプリート</figcaption>
				</figure>
      </li>
      <li>
				前の手順を繰り返して、<strong>Client ID</strong>と<strong>Client Secret</strong>フィールドに<code translate="no">client_id</code>と<code translate="no">client_secret</code>変数を入力します：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/auth-variables.png" alt="Auth Variables">
					<figcaption class="bcls-caption--image">認証変数</figcaption>
				</figure>
			</li>
      <li>
				下にスクロールして、<strong>Fetch Token</strong>ボタンをクリックしてクリックします。[Access Token]フィールドにトークンが入力されていることを確認します。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/access-token.png" alt="Access Token">
					<figcaption class="bcls-caption--image">アクセストークン</figcaption>
				</figure>
			</li>
      <li><strong>Fetch Token</strong>をクリックして、これが機能することを確認します。次のような応答が表示されます。
        <figure class="bcls-figure"><img class="bcls-image" alt="Access Token" src="/assets/images/general/insomnia/18462-access-token.png" />
          <figcaption class="bcls-caption--image">アクセストークン</figcaption>
        </figure>
        <aside class="bcls-aside bcls-aside--information"><span translate="No">Insomnia</span>の優れたところは、一度設定すると手動でトークンを更新する必要が<strong>ない</strong>ことです - <span translate="No">Insomnia</span>必要に応じて自動的に新しいものを取得します。</aside>
      </li>
			<li>
				<strong>Header</strong>タブで<strong>Authorization</strong>ヘッダーを削除して下さい（先程設定した認証でheadが処理され-これでheaderは壊れています）：
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/remove-authorization-header.png" alt="Remove Authorization Header">
					<figcaption class="bcls-caption--image">承認ヘッダーを削除する</figcaption>
				</figure>
			</li>
    </ol>
		<aside class="bcls-aside bcls-aside--information">注意:
			<ul>
				<li><span class="”notranslate”">Insomnia</span>は認証設定を他のリクエストに複製しないため、テストしたい各リクエストで、この手順を繰り返す必要があります。</li>
				<li><span class="”notranslate”">Insomnia</span>の良いところは、一度OAuth 2認証を設定すると、必要に応じて新しいアクセストークンを自動的に取得することです。既存のアクセストークンの有効期限が切れたときに、手動で新しいアクセストークンを取得する必要はありません。</li>
			</ul>
		</aside>
  </section>
	<section class="bcls-section">
		<h2 id="Make_a_request">リクエストする</h2>
		<p>これで<strong>Get Videos</strong>のリクエストをする準備が整いました。</p>
		<ol class="bcls-tasklist-restart">
			<li>これは<code translate="no">GET</code>リクエストなので、あとは<strong>Send</strong>をクリックするだけです。</li>
			<li>
				レスポンスエリアにJSONレスポンスが表示されるのが確認できるはずです。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/get-response.png" alt="API Response">
					<figcaption class="bcls-caption--image">API レスポンス</figcaption>
				</figure>
			</li>
			<li>
				<strong>Query</strong>パラメータを使用することで、異なる動画セットを取得できることに注意してください。リクエストの<strong>Query</strong>タブをクリックすると、<span class="”notranslate”">Insomnia</span>が、OpenAPI仕様に基づいたパラメータを設定していることがわかります。使いたいパラメータにチェックを入れて、値を設定するだけです。
				<figure class="bcls-figure">
					<img class="bcls-image" src="/assets/images/general/insomnia/query-params.png" alt="Query Params">
					<figcaption class="bcls-caption--image">クエリパラメータ</figcaption>
				</figure>
			</li>
	</ol>
	</section>
  <section class="bcls-section">
    <h2 id="postRequest"><code translate="No">POST</code>リクエストの送信</h2>
    <p>ここでは、いくつかのデータを含む<code translate="No">POST</code>リクエストを送信します。今回、CMS APIを使用して新しいビデオオブジェクトを作成します。<strong>Video</strong>フォルダにある<strong>Create Video</strong>リクエストを選択して開始します。</p>
    <ol class="bcls-tasklist-restart">
			<li>上記の<a href="#Set_up_authentication">認証を設定</a>セクションの全ての手順を繰り返して、この新しいリクエストの認証を設定します。</li>
			<li>
				このリクエストにはリクエスト本文が必要なので、[JSON]タブをクリックし、このJSONコードを入力して<code translate="no">null</code>を置き換えます：
<pre class="line-numbers"><code class="language-json" translate="No">{
	"name": "Insomnia Test"
}</code></pre>
<figure class="bcls-figure">
  <img class="bcls-image" src="/assets/images/general/insomnia/request-body.png" alt="Request Body">
  <figcaption class="bcls-caption--image">リクエスト本文</figcaption>
</figure>
			</li>
			<li><strong>送信</strong>をクリックすると、新しいビデオオブジェクトがレスポンスで表示されます。</li>
    </ol>
  </section>
  <section class="bcls-section">
    <h2 id="Using_the_code_generators">コードジェネレーターの使用</h2>
    <p><span class="”notranslate”">Insomnia</span>のもう一つの素晴らしい特徴は、様々な言語でリクエストを行うためのコードを生成するということです。</p>
    <ol class="bcls-tasklist-restart">
      <li>
        リクエストのドロップダウンメニューにカーソルを合わせます。
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/general/insomnia/dropdown-menu-for-requests.png" alt="Request Dropdown Menu">
          <figcaption class="bcls-caption--image">ドロップダウンメニューのリクエスト</figcaption>
        </figure>
      </li>
      <li>
        メニューから<strong>Generate Code</strong>を選択します：
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/general/insomnia/generate-code-option.png" alt="Select Generate Code">
          <figcaption class="bcls-caption--image">[コードの生成]を選択します</figcaption>
        </figure>
      </li>
      <li>
        <strong>Generate Client Code</strong>ダイアログが表示されたら、コードを作成する言語を選択します。
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/general/insomnia/choose-code-type.png" alt="Select the Language">
          <figcaption class="bcls-caption--image">言語を選択してください</figcaption>
        </figure>
      </li>
      <li>
        多くの言語では、作成するアプリの種類に適した、選択可能なバリアントもあります。
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/general/insomnia/choose-code-variants.png" alt="Select Code Variant">
          <figcaption class="bcls-caption--image">コードバリアントを選択</figcaption>
        </figure>
      </li>
      <li>
        コードをクリップボードにコピーするための便利なボタンもあります。
        <figure class="bcls-figure">
          <img class="bcls-image" src="/assets/images/general/insomnia/view-copy-code.png" alt="View and Copy Code">
          <figcaption class="bcls-caption--image">コードの表示とコピー</figcaption>
        </figure>
      </li>
    </ol>
  </section>
  <section class="bcls-section">
    <h2 id="Conclusion">まとめ</h2>
    <p><span translate="No">Insomnia</span> を使用してBrightcove APIにリクエストを行うための基本的な方法はご理解頂けたと思います。無料の<span translate="No">Insomnia</span>アカウントをチームアカウントにアップグレードすると、全てのリクエストと環境を同期して、他のチームメンバーと共有することもできますのでご注意ください。</p>
  </section>
</article>